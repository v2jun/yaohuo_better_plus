# 妖火网增强脚本

### 介绍

妖火网增强脚本，让妖火再次伟大（手动狗头.jpg）

###### 注 1：本脚本依赖远程加载 JQuery 实现相关功能，所以当网不好或者 JQuery 的 CDN 出错时会无法执行相关功能，属于正常情况，不在 bug 范围内，也不会考虑自己实现相关功能，勿反馈，反馈了也没用 (｡◕ˇ∀ˇ◕)

###### 注 2：绝大部分功能均可单独开启和关闭（未做开关的都是我觉得没有必要控制的，有需求再说），不保证兼容其他插件，使用其他插件的请自行测试，与其他脚本的兼容性问题不在修复范围内

### 功能列表

##### 基础功能

- [x] 一键回到顶部/底部
- [x] 隐藏勋章
- [x] 发帖增强
- [x] 回帖增强
  - [x] 表情增强
  - [x] ubb 增强 ……

##### 高级功能

使用以下功能前，请先阅读并背诵版规(手动狗头.jpg)，不要影响论坛正常体验以下功能默认关闭，请自行查看源码获取打开方式

- [x] 一键吃肉
- [x] 吹牛历史查询
- [x] 复读机(回复+1) ……

### 使用说明

使用支持脚本的浏览器加载脚本即可

电脑推荐油猴插件，安卓手机推荐 360 极速浏览器/via，ios 推荐 360 浏览器/alook

tips：快速点击设置里的脚本名称有惊喜

### 感谢名单

脚本编写过程中参考并使用了部分网友/妖友的代码（毕竟没有什么比 cv 大法更快了），包括但不限于(如果发现使用了你的代码，但是没在名单内可以站内私信我，我给你加上)：

- ▌ 壹贰叁肆吳 ┃ 彦祖@24407
- 龙少 c@20469
- 外卖不用券@23825
- 无糖奶盖@28090
- 烟花小神 Joker@24974
- 五万药友的梦@40498 ……

#### 更新日志

- 0.1.0
  - 【新增】一键回到顶部/底部
- 0.2.0
  - 【新增】吹牛发布者历史查询
  - 【修复】一键回到顶部/底部 在移动端显示错位问题
- 0.3.0
  - 【优化】吹牛历史发布查询相关代码，使其更精简高效
  - 【新增】设置按钮、弹出内容区域（设置项尚未填充）
- 0.4.0
  - 【新增&优化】当前网址检测，避免移动端浏览器不识别油猴标识导致脚本在其他网站运行
  - 【新增】一键吃肉
- 0.5.0
  - 【优化】一键吃肉判断逻辑，避免没肉硬吃（简称水回复）
  - 【优化】设置弹窗大小,适配移动端
  - 【优化】一键回到顶部/底部 按钮增大，方便移动端点击
  - 【新增】隐藏楼主勋章
  - 【优化】完善相关设置项
- 0.6.0
  - 【优化】重构网址检测，直接采取 location.host 判断，快准狠
  - 【新增】首次使用确认提示
  - 【优化】完善设置项目，新增高级设置相关
  - 【新增】复读机(回复+1)
- 0.7.0
  - 【新增】回帖表情增强
  - 【新增&优化】新增部分设置，优化设置逻辑
- 0.8.0
  - 【优化】重构快速回复点击逻辑，避免移动端键盘非必要的弹出
  - 【优化】复读机按钮内容不换行
  - 【新增】页面图片自动缩小
- 0.8.1
  - 【修复】图片为 gif 时无法点击放大/缩小
- 0.9.0
  - 【修复】图片为上传到论坛附件时，点击进入预览
  - 【优化】复读机+1 时，将输入框滚动到屏幕中间，以便查看是否回复成功
  - 【优化】表情增强大小，手机端方便操作
  - 【新增】发帖/回帖 ubb 增强设置及相关内容
- 0.9.1
  - 【修复】完善发帖/回帖 ubb 功能
- 0.9.2
  - 【优化】重构回帖表情增强功能
  - 【优化】取消部分设置项，新增部分设置 tips
- 0.9.3
  - 【修复】回帖 ubb 默认展开时显示文字错误
  - 【优化】复读机逻辑，更符合直觉
  - 【新增】重置设置按钮，避免玄学 bug 产生
- 0.9.4
  - 【优化】发帖/回帖 ubb 样式微调
- 0.9.5
  - 【新增】复读机是否自动回复开关。点击+1 按钮后是否自动提交
  - 【优化】将设置 icon 更改为 base64，避免原图图片加载失败时设置按钮显示错误
  - 【优化】隐藏部分因为种种原因而未完成 ubb 选项
  - 【优化】图片缩放样式，避免图片并排
- 1.0.0 正式版发布
- 1.1.0
  - 【修复】发帖增强 ubb 在修改帖子页面不生效
  - 【修复】复读机在新版回帖下不生效
  - 【新增】页面内设置按钮，解决某些妖友将设置 icon 大小设置为 0 时不知道怎么重置设置的问题。同时解决因图标无法移动带来的某些情况下影响浏览/回复的问题(将 icon 大小设置为 0 即可)
- 1.2.0
  - 【修复】发帖表情增强插入错误
  - 【新增】发帖 ubb “图片”点击可以直接上传到图床并回显了(需配置水墨图床 token，感谢水墨图床的支持)
- 1.2.1
  - 【新增】重置设置
  - 【修复】引入新版回帖复读机引起的旧版回帖不生效(ps:bug 产生原因是老 C 存在 localstorage 的是单纯的字符串，导致直接取出来判断 bool 一直是 true)
  - 【修复】当图片缩放宽度设置为 0 时，点击事件依旧存在，从而导致点击页面内图片造成图片丢失的问题
  - 【优化】设置内容样式，更符合手机端使用；取消无用动画，降低性能开销
  - 【优化】发帖 ubb “图片”点击事件逻辑。在未配置 token 时向输入框插入默认 ubb
- 1.3.0
  - 【移除】复读机相关功能设置
  - 【新增】修改惯用手(将帖子列表底部“上一页”“下一页”按钮位置互换，妖友疑问，我觉得可以实现，原贴：https://yaohuo.me/bbs-1360801.html)
  - 【新增】帖子列表自动加载更多
  - 【新增】回帖自动加载更多
  - 【新增】PC 端，点击帖子弹窗打开(修改妖友代码，原贴https://yaohuo.me/bbs/book_view.aspx?id=1361242&siteid=1000&classid=177)
- 1.3.1
  - 【修复】帖子/回复列表加载更多重复点击问题
  - 【优化】帖子列表加载更多阈值，手机端体验更流畅
  - 【优化】图片缩放执行时机，解决因页面内图片加载慢导致的部分图片不缩放问题
- 1.4.0
  - 【优化】调整发帖/回帖 ubb 样式及功能，可以更方便的水贴/回帖了
  - 【新增】更多有趣(沙雕)表情
- 1.4.1
  - 【修复】新版发帖/修改贴子页面 ubb 失效问题(万恶的老 C，凭空给我增加工作量)
  - 【移除】ubb 列表内音频 ubb(感觉无实际意义，大家也基本不会点开语音条，不如表情包来得实在)
  - 【优化】图片缩放逻辑，不再缩放评论区图片
  - 【优化】展开/折叠 提示文字，风格更统一
- 1.5.0
  - 【优化】jquery 不再使用油猴标识加载，浏览器兼容性更高，使用更简单，加载速度更快
  - 【优化】图床 token 不再隐藏(没有什么实际意义)
  - 【修复】发帖页面表情框重复
- 1.5.1
  - 【优化】jquery 采用本地缓存，二次加载不再从远端加载，进一步提升加载速度
  - 【新增】更多有趣(沙雕)表情(首次加载有点慢)
- 1.5.2
  - 【修复】再次尝试修复图片缩放失效问题，用了全新的方法，应该能解决问题把~~~
  - 【修复】使用 ubb 上传图片时，图片重复上传问题
  - 【修复】使用 ubb 上传图片时，两次选中相同图片时，不上传问题
  - 【优化】评论区自定义表情包统一宽度为100px，避免图片太大影响看帖
- 1.6.0
  - 【新增】检查更新及相关提示(再也不用担心我的脚本过时了.jpg)
  - 【修复】部分 ubb 插入错误问题(cv大法的后遗症)
  - 【优化】ubb 输入提示文字，更易懂清晰
  - 【优化】移除部分已废弃代码，精简代码体积
- 1.6.1
  - 【优化】帖子图片缩放大小，从原来的默认100px修改为200px，看起来稍微方便点
  - 【优化】表情展开显示大小(现在太小了，沙雕表情不太能看清楚，不方便回帖)
  - 【优化】设置里的重置设置现在会顺带清除缓存的 jquery 了，进一步避免玄学bug的产生
- 1.6.2
  - 【新增】表情点击后自动关闭(表情区域太大了，自动关闭更方便看帖)
  - 【优化】评论区自动加载更多图片缩放逻辑
- 1.7.0
  - 【新增】抖音，快手，TikTok 视频/图集/直播解析(感谢 @柯乐/47896 提供的api)
  - 【修复】图片缩放设置为0时点击依旧缩放(用ai改的代码，把逻辑整体改了，原本是好的)
  - 【修复】部分GIF表情包上传到图床后，不动的问题(还是偷妖友现成的链接简单)
  - 【新增】更多有趣(沙雕)表情
  - 【新增】表情分页，每次加载5行(表情太多了，一次性加载出来影响正常浏览帖子)
- 1.7.1
  - 【修复】发表非普通贴(资源贴，派币贴等)ubb/表情重复生成
  - 【兼容】发表资源贴时，点击外站资源，再点击本地上传时，页面路径会变成大写导致的ubb/表情失效(万恶的老C，有bug不修)
  - 【修复】回帖页面表情无法插入输入框(老C总是悄悄改东西……)
  - 【修复】回帖页面 ubb 无法展开(理由同上)
- 1.7.2
  - 【修复】设置弹窗在帖子详情页面无法正常显示(万恶的老C，用AI生成的代码，用了和我一样的 css class 名)
  - 【优化】见上一条，修改了所有可能冲突的 css class 名(免得老C又突然改啥代码，整写玄学bug出来)
  - 【修复】回帖/发帖表情分页页码互相覆盖导致的分页记忆出错
  - 【修复】私信页面点击帖子跳转详情页面，部分脚本不生效(和正常点击去路径居然不一样)
  - 【优化】发帖/回帖图片上传逻辑，不在批量上传，改为逐张上传，避免由于接口出问题导致一直卡上传等待。顺带解决了批量上传图片时，返回url顺序错乱的问题。修改了ubb的插入，每一张图片现在都是单独的一行了，免得一大堆看起来不清楚
  - 【修复】某些情况下，回帖/发帖时，ubb/表情自动折叠失效
- 1.7.3
  - 【新增】输入框自动获取焦点功能设置
  - 【修复】新版回帖复读机不生效(吐槽老C.jpg)
  - 【优化】复读机现在支持复制常见UBB了(图片、音频、视频、链接)
  - 【优化】上一页/下一页按钮位置互换，在所有页面都可以生效了
  - 【移除】查询吹牛数据设置，后期再考虑是否修复(我每次上来想改这个代码，都没有人发牛让我测代码，可恶的老C，给我增加工作量)
- 1.7.4
  - 【新增】用户黑名单增强，通过用户ID匹配，单向屏蔽XX的帖子和回复(已默认将管理员、版主加入白名单)。如需双向屏蔽请支持老C的工作，充值VIP即可。(以前都觉得论坛没这么多xx，都没用过黑名单。感谢 @四喜/20740 的代码，在他的基础上优化了下，并修复了部分bug。由于老C不允许脚本黑名单的存在，所以此功能不提供开关，有需要请自行研究)
  - 【新增】楼主/评论区 加入黑名单按钮，方便快速屏蔽XX
  - 【新增】图片模糊效果(可与图片缩放搭配使用，再也不用担心点开帖子突然冒出一些奇怪的内容，被旁边的人看到导致社死了)(这个想法是在GreasyFork上看到的，不知道是论坛哪位老哥写的，需要加作者请私聊我。在他的基础上做了一点优化，更好用了点)
  - 【优化】评论区加载更多图片缩放逻辑(改了好几次了，这次应该没啥bug了，把~)
  - 【修复】评论区加载更多时，复读机无法生效问题
- 1.7.5
  - 【新增】导入/导出配置，方便用户迁移配置
  - 【新增】表情包自定义输入框，用户可以自行添加表情包(老C再也不用担心表情包不够用了，狗头.JPG)，配合新增的配置导入/导出，可以轻松做到多端同步自己的专属表情包
- 1.8.0
  - 【新增】音频/视频上传，感谢 @by柯乐/47896
  - 【修复】偶发性 ubb/表情 列表无法展开
  - 【修复】偶发性，上一页/下一页按钮点击事件没有正确生效
  - 【修复】从空间-动态 进入帖子详情时，部分脚本不生效
  - 【修复】音频插入ubb错误
  - 【修复】回复帖子导致的评论区相关功能失效
  - 【修复】评论区加载更多时，复读机按钮重复生成/失效
  - 【修复】评论区加载更多时，黑名单按钮重复生成/失效
- 1.8.1
  - 【修复】修改帖子页正确按钮样式出错(老C背大锅，总是悄悄改代码)
  - 【修复】回复帖子时，楼主黑名单按钮重复生成
  - 【修复】美团图床上传失败(妖友的 api 地址改了，但我平时没用美团图床)
  - 【修复】快手解析失效(其实只是联系妖友修了接口)
  - 【新增】ubb 增强 MarkDown 格式支持